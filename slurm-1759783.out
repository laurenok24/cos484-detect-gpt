Saving results to absolute path: /scratch/network/tb19/cos484-detect-gpt/tmp_results/cos484-temperature/gpt2-t5-3b-temp/2023-05-02-20-55-54-257487-fp32-0.3-1-xsum-500
Using cache dir /scratch/network/tb19/.cache
Loading BASE model gpt2...
Loading mask filling model t5-3b...
MOVING BASE MODEL TO GPU...Using the latest cached version of the module from /home/tb19/.cache/huggingface/modules/datasets_modules/datasets/xsum/082863bf4754ee058a5b6f6525d0cb2b18eadb62c7b370b095d1364050a52b71 (last modified on Tue Apr 18 20:13:01 2023) since it couldn't be found locally at xsum., or remotely on the Hugging Face Hub.
Found cached dataset xsum (/scratch/network/tb19/.cache/xsum/default/1.2.0/082863bf4754ee058a5b6f6525d0cb2b18eadb62c7b370b095d1364050a52b71)
Token indices sequence length is longer than the specified maximum sequence length for this model (853 > 512). Running this sequence through the model will result in indexing errors
DONE (0.50s)
Loading dataset xsum...
Total number of samples: 1829
Average number of words: 306.9710224166211
Generating samples for batch 0 of 10
Generating samples for batch 1 of 10
Generating samples for batch 2 of 10
Generating samples for batch 3 of 10
Generating samples for batch 4 of 10
Generating samples for batch 5 of 10
Generating samples for batch 6 of 10
Generating samples for batch 7 of 10
Generating samples for batch 8 of 10
Generating samples for batch 9 of 10
Writing raw data to tmp_results/cos484-temperature/gpt2-t5-3b-temp/2023-05-02-20-55-54-257487-fp32-0.3-1-xsum-500/raw_data.json
Computing likelihood criterion:   0%|          | 0/10 [00:00<?, ?it/s]Computing likelihood criterion:  10%|█         | 1/10 [00:00<00:07,  1.14it/s]Computing likelihood criterion:  20%|██        | 2/10 [00:01<00:07,  1.14it/s]Computing likelihood criterion:  30%|███       | 3/10 [00:02<00:06,  1.14it/s]Computing likelihood criterion:  40%|████      | 4/10 [00:03<00:05,  1.14it/s]Computing likelihood criterion:  50%|█████     | 5/10 [00:04<00:04,  1.14it/s]Computing likelihood criterion:  60%|██████    | 6/10 [00:05<00:03,  1.13it/s]Computing likelihood criterion:  70%|███████   | 7/10 [00:06<00:02,  1.14it/s]Computing likelihood criterion:  80%|████████  | 8/10 [00:07<00:01,  1.14it/s]Computing likelihood criterion:  90%|█████████ | 9/10 [00:07<00:00,  1.13it/s]Computing likelihood criterion: 100%|██████████| 10/10 [00:08<00:00,  1.13it/s]Computing likelihood criterion: 100%|██████████| 10/10 [00:08<00:00,  1.14it/s]
likelihood_threshold ROC AUC: 0.921442, PR AUC: 0.9067845631714825
Computing rank criterion:   0%|          | 0/10 [00:00<?, ?it/s]Computing rank criterion:  10%|█         | 1/10 [00:01<00:09,  1.05s/it]Computing rank criterion:  20%|██        | 2/10 [00:02<00:08,  1.05s/it]Computing rank criterion:  30%|███       | 3/10 [00:03<00:07,  1.05s/it]Computing rank criterion:  40%|████      | 4/10 [00:04<00:06,  1.05s/it]Computing rank criterion:  50%|█████     | 5/10 [00:05<00:05,  1.05s/it]Computing rank criterion:  60%|██████    | 6/10 [00:06<00:04,  1.06s/it]Computing rank criterion:  70%|███████   | 7/10 [00:07<00:03,  1.05s/it]Computing rank criterion:  80%|████████  | 8/10 [00:08<00:02,  1.05s/it]Computing rank criterion:  90%|█████████ | 9/10 [00:09<00:01,  1.06s/it]Computing rank criterion: 100%|██████████| 10/10 [00:10<00:00,  1.06s/it]Computing rank criterion: 100%|██████████| 10/10 [00:10<00:00,  1.05s/it]
rank_threshold ROC AUC: 0.829134, PR AUC: 0.8476041461599431
Computing log_rank criterion:   0%|          | 0/10 [00:00<?, ?it/s]Computing log_rank criterion:  10%|█         | 1/10 [00:01<00:09,  1.05s/it]Computing log_rank criterion:  20%|██        | 2/10 [00:02<00:08,  1.05s/it]Computing log_rank criterion:  30%|███       | 3/10 [00:03<00:07,  1.05s/it]Computing log_rank criterion:  40%|████      | 4/10 [00:04<00:06,  1.05s/it]Computing log_rank criterion:  50%|█████     | 5/10 [00:05<00:05,  1.06s/it]Computing log_rank criterion:  60%|██████    | 6/10 [00:06<00:04,  1.06s/it]Computing log_rank criterion:  70%|███████   | 7/10 [00:07<00:03,  1.05s/it]Computing log_rank criterion:  80%|████████  | 8/10 [00:08<00:02,  1.06s/it]Computing log_rank criterion:  90%|█████████ | 9/10 [00:09<00:01,  1.06s/it]Computing log_rank criterion: 100%|██████████| 10/10 [00:10<00:00,  1.06s/it]Computing log_rank criterion: 100%|██████████| 10/10 [00:10<00:00,  1.06s/it]
log_rank_threshold ROC AUC: 0.9559399999999999, PR AUC: 0.9481463894227873
Computing entropy criterion:   0%|          | 0/10 [00:00<?, ?it/s]Computing entropy criterion:  10%|█         | 1/10 [00:00<00:08,  1.12it/s]Computing entropy criterion:  20%|██        | 2/10 [00:01<00:07,  1.11it/s]Computing entropy criterion:  30%|███       | 3/10 [00:02<00:06,  1.11it/s]Computing entropy criterion:  40%|████      | 4/10 [00:03<00:05,  1.11it/s]Computing entropy criterion:  50%|█████     | 5/10 [00:04<00:04,  1.11it/s]Computing entropy criterion:  60%|██████    | 6/10 [00:05<00:03,  1.11it/s]Computing entropy criterion:  70%|███████   | 7/10 [00:06<00:02,  1.11it/s]Computing entropy criterion:  80%|████████  | 8/10 [00:07<00:01,  1.11it/s]Computing entropy criterion:  90%|█████████ | 9/10 [00:08<00:00,  1.10it/s]Computing entropy criterion: 100%|██████████| 10/10 [00:09<00:00,  1.11it/s]Computing entropy criterion: 100%|██████████| 10/10 [00:09<00:00,  1.11it/s]
Some weights of the model checkpoint at roberta-base-openai-detector were not used when initializing RobertaForSequenceClassification: ['roberta.pooler.dense.weight', 'roberta.pooler.dense.bias']
- This IS expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
entropy_threshold ROC AUC: 0.521396, PR AUC: 0.5120989880212529
Beginning supervised evaluation with roberta-base-openai-detector...
Evaluating real:   0%|          | 0/10 [00:00<?, ?it/s]Evaluating real:  10%|█         | 1/10 [00:00<00:01,  5.98it/s]Evaluating real:  20%|██        | 2/10 [00:00<00:01,  6.16it/s]Evaluating real:  30%|███       | 3/10 [00:00<00:01,  6.40it/s]Evaluating real:  40%|████      | 4/10 [00:00<00:00,  6.36it/s]Evaluating real:  50%|█████     | 5/10 [00:00<00:00,  6.52it/s]Evaluating real:  60%|██████    | 6/10 [00:00<00:00,  6.47it/s]Evaluating real:  70%|███████   | 7/10 [00:01<00:00,  6.54it/s]Evaluating real:  80%|████████  | 8/10 [00:01<00:00,  6.60it/s]Evaluating real:  90%|█████████ | 9/10 [00:01<00:00,  6.66it/s]Evaluating real: 100%|██████████| 10/10 [00:01<00:00,  6.67it/s]Evaluating real: 100%|██████████| 10/10 [00:01<00:00,  6.53it/s]
Evaluating fake:   0%|          | 0/10 [00:00<?, ?it/s]Evaluating fake:  10%|█         | 1/10 [00:00<00:01,  7.44it/s]Evaluating fake:  20%|██        | 2/10 [00:00<00:01,  7.40it/s]Evaluating fake:  30%|███       | 3/10 [00:00<00:00,  7.43it/s]Evaluating fake:  40%|████      | 4/10 [00:00<00:00,  7.43it/s]Evaluating fake:  50%|█████     | 5/10 [00:00<00:00,  7.43it/s]Evaluating fake:  60%|██████    | 6/10 [00:00<00:00,  7.43it/s]Evaluating fake:  70%|███████   | 7/10 [00:00<00:00,  7.44it/s]Evaluating fake:  80%|████████  | 8/10 [00:01<00:00,  7.44it/s]Evaluating fake:  90%|█████████ | 9/10 [00:01<00:00,  7.43it/s]Evaluating fake: 100%|██████████| 10/10 [00:01<00:00,  7.42it/s]Evaluating fake: 100%|██████████| 10/10 [00:01<00:00,  7.43it/s]
Some weights of the model checkpoint at roberta-large-openai-detector were not used when initializing RobertaForSequenceClassification: ['roberta.pooler.dense.weight', 'roberta.pooler.dense.bias']
- This IS expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
roberta-base-openai-detector ROC AUC: 0.994592, PR AUC: 0.9869139047446183
Beginning supervised evaluation with roberta-large-openai-detector...
Evaluating real:   0%|          | 0/10 [00:00<?, ?it/s]Evaluating real:  10%|█         | 1/10 [00:00<00:05,  1.65it/s]Evaluating real:  20%|██        | 2/10 [00:01<00:04,  1.85it/s]Evaluating real:  30%|███       | 3/10 [00:01<00:03,  1.98it/s]Evaluating real:  40%|████      | 4/10 [00:02<00:03,  2.00it/s]Evaluating real:  50%|█████     | 5/10 [00:02<00:02,  2.06it/s]Evaluating real:  60%|██████    | 6/10 [00:03<00:01,  2.05it/s]Evaluating real:  70%|███████   | 7/10 [00:03<00:01,  2.08it/s]Evaluating real:  80%|████████  | 8/10 [00:03<00:00,  2.11it/s]Evaluating real:  90%|█████████ | 9/10 [00:04<00:00,  2.12it/s]Evaluating real: 100%|██████████| 10/10 [00:04<00:00,  2.14it/s]Evaluating real: 100%|██████████| 10/10 [00:04<00:00,  2.06it/s]
Evaluating fake:   0%|          | 0/10 [00:00<?, ?it/s]Evaluating fake:  10%|█         | 1/10 [00:00<00:03,  2.34it/s]Evaluating fake:  20%|██        | 2/10 [00:00<00:03,  2.33it/s]Evaluating fake:  30%|███       | 3/10 [00:01<00:02,  2.34it/s]Evaluating fake:  40%|████      | 4/10 [00:01<00:02,  2.34it/s]Evaluating fake:  50%|█████     | 5/10 [00:02<00:02,  2.34it/s]Evaluating fake:  60%|██████    | 6/10 [00:02<00:01,  2.34it/s]Evaluating fake:  70%|███████   | 7/10 [00:02<00:01,  2.34it/s]Evaluating fake:  80%|████████  | 8/10 [00:03<00:00,  2.34it/s]Evaluating fake:  90%|█████████ | 9/10 [00:03<00:00,  2.34it/s]Evaluating fake: 100%|██████████| 10/10 [00:04<00:00,  2.34it/s]Evaluating fake: 100%|██████████| 10/10 [00:04<00:00,  2.34it/s]
roberta-large-openai-detector ROC AUC: 0.999996, PR AUC: 0.9999960039920159
MOVING MASK MODEL TO GPU...DONE (1.33s)
Applying perturbations:   0%|          | 0/2500 [00:00<?, ?it/s]Applying perturbations:   0%|          | 1/2500 [00:01<1:20:14,  1.93s/it]Applying perturbations:   0%|          | 2/2500 [00:03<1:21:19,  1.95s/it]Applying perturbations:   0%|          | 3/2500 [00:05<1:21:23,  1.96s/it]Applying perturbations:   0%|          | 4/2500 [00:07<1:19:49,  1.92s/it]Applying perturbations:   0%|          | 5/2500 [00:09<1:19:50,  1.92s/it]Applying perturbations:   0%|          | 6/2500 [00:11<1:18:52,  1.90s/it]Applying perturbations:   0%|          | 7/2500 [00:13<1:17:34,  1.87s/it]Applying perturbations:   0%|          | 8/2500 [00:15<1:17:26,  1.86s/it]Applying perturbations:   0%|          | 9/2500 [00:17<1:17:34,  1.87s/it]Applying perturbations:   0%|          | 10/2500 [00:18<1:18:39,  1.90s/it]Applying perturbations:   0%|          | 11/2500 [00:21<1:20:10,  1.93s/it]Applying perturbations:   0%|          | 12/2500 [00:22<1:19:54,  1.93s/it]Applying perturbations:   1%|          | 13/2500 [00:24<1:21:31,  1.97s/it]Applying perturbations:   1%|          | 14/2500 [00:26<1:21:22,  1.96s/it]Applying perturbations:   1%|          | 15/2500 [00:28<1:21:14,  1.96s/it]Applying perturbations:   1%|          | 16/2500 [00:30<1:19:33,  1.92s/it]Applying perturbations:   1%|          | 17/2500 [00:32<1:17:35,  1.88s/it]Applying perturbations:   1%|          | 18/2500 [00:34<1:17:56,  1.88s/it]Applying perturbations:   1%|          | 19/2500 [00:36<1:15:50,  1.83s/it]Applying perturbations:   1%|          | 20/2500 [00:37<1:14:57,  1.81s/it]Applying perturbations:   1%|          | 21/2500 [00:39<1:14:39,  1.81s/it]Applying perturbations:   1%|          | 22/2500 [00:41<1:14:47,  1.81s/it]Applying perturbations:   1%|          | 23/2500 [00:43<1:14:34,  1.81s/it]Applying perturbations:   1%|          | 24/2500 [00:45<1:14:21,  1.80s/it]Applying perturbations:   1%|          | 25/2500 [00:46<1:15:26,  1.83s/it]Applying perturbations:   1%|          | 26/2500 [00:48<1:16:04,  1.84s/it]Applying perturbations:   1%|          | 27/2500 [00:50<1:16:36,  1.86s/it]Applying perturbations:   1%|          | 28/2500 [00:52<1:16:05,  1.85s/it]Applying perturbations:   1%|          | 29/2500 [00:54<1:17:03,  1.87s/it]Applying perturbations:   1%|          | 30/2500 [00:56<1:16:22,  1.86s/it]Applying perturbations:   1%|          | 31/2500 [00:58<1:17:15,  1.88s/it]Applying perturbations:   1%|▏         | 32/2500 [01:00<1:17:37,  1.89s/it]Applying perturbations:   1%|▏         | 33/2500 [01:02<1:18:07,  1.90s/it]Applying perturbations:   1%|▏         | 34/2500 [01:04<1:18:46,  1.92s/it]Applying perturbations:   1%|▏         | 35/2500 [01:05<1:18:01,  1.90s/it]Applying perturbations:   1%|▏         | 36/2500 [01:07<1:19:04,  1.93s/it]Applying perturbations:   1%|▏         | 37/2500 [01:09<1:19:08,  1.93s/it]Applying perturbations:   2%|▏         | 38/2500 [01:11<1:19:47,  1.94s/it]Applying perturbations:   2%|▏         | 39/2500 [01:13<1:18:58,  1.93s/it]Applying perturbations:   2%|▏         | 40/2500 [01:15<1:19:41,  1.94s/it]Applying perturbations:   2%|▏         | 41/2500 [01:17<1:19:02,  1.93s/it]Applying perturbations:   2%|▏         | 42/2500 [01:19<1:17:38,  1.90s/it]Applying perturbations:   2%|▏         | 43/2500 [01:21<1:16:57,  1.88s/it]Applying perturbations:   2%|▏         | 44/2500 [01:23<1:16:36,  1.87s/it]Applying perturbations:   2%|▏         | 45/2500 [01:24<1:16:38,  1.87s/it]Applying perturbations:   2%|▏         | 46/2500 [01:26<1:16:34,  1.87s/it]Applying perturbations:   2%|▏         | 47/2500 [01:28<1:17:07,  1.89s/it]Applying perturbations:   2%|▏         | 48/2500 [01:30<1:18:09,  1.91s/it]Applying perturbations:   2%|▏         | 49/2500 [01:32<1:18:52,  1.93s/it]Applying perturbations:   2%|▏         | 50/2500 [01:34<1:19:21,  1.94s/it]Applying perturbations:   2%|▏         | 51/2500 [01:36<1:21:08,  1.99s/it]Applying perturbations:   2%|▏         | 52/2500 [01:38<1:21:42,  2.00s/it]Applying perturbations:   2%|▏         | 53/2500 [01:40<1:21:27,  2.00s/it]Applying perturbations:   2%|▏         | 54/2500 [01:42<1:21:54,  2.01s/it]Applying perturbations:   2%|▏         | 55/2500 [01:44<1:21:52,  2.01s/it]Applying perturbations:   2%|▏         | 56/2500 [01:46<1:14:56,  1.84s/it]Applying perturbations:   2%|▏         | 57/2500 [01:47<1:09:48,  1.71s/it]Applying perturbations:   2%|▏         | 58/2500 [01:49<1:05:27,  1.61s/it]Applying perturbations:   2%|▏         | 59/2500 [01:50<1:03:27,  1.56s/it]Applying perturbations:   2%|▏         | 60/2500 [01:51<1:01:27,  1.51s/it]Applying perturbations:   2%|▏         | 61/2500 [01:53<1:06:01,  1.62s/it]Applying perturbations:   2%|▏         | 62/2500 [01:55<1:10:04,  1.72s/it]Applying perturbations:   3%|▎         | 63/2500 [01:57<1:11:53,  1.77s/it]Applying perturbations:   3%|▎         | 64/2500 [01:59<1:13:08,  1.80s/it]Applying perturbations:   3%|▎         | 65/2500 [02:01<1:14:15,  1.83s/it]Applying perturbations:   3%|▎         | 66/2500 [02:03<1:15:26,  1.86s/it]Applying perturbations:   3%|▎         | 67/2500 [02:05<1:15:24,  1.86s/it]Applying perturbations:   3%|▎         | 68/2500 [02:07<1:15:55,  1.87s/it]Applying perturbations:   3%|▎         | 69/2500 [02:08<1:16:18,  1.88s/it]Applying perturbations:   3%|▎         | 70/2500 [02:10<1:15:38,  1.87s/it]Applying perturbations:   3%|▎         | 71/2500 [02:12<1:15:13,  1.86s/it]Applying perturbations:   3%|▎         | 72/2500 [02:14<1:15:52,  1.87s/it]Applying perturbations:   3%|▎         | 73/2500 [02:16<1:15:59,  1.88s/it]Applying perturbations:   3%|▎         | 74/2500 [02:18<1:18:31,  1.94s/it]Applying perturbations:   3%|▎         | 75/2500 [02:20<1:17:36,  1.92s/it]Applying perturbations:   3%|▎         | 76/2500 [02:22<1:18:34,  1.94s/it]Applying perturbations:   3%|▎         | 77/2500 [02:24<1:19:42,  1.97s/it]Applying perturbations:   3%|▎         | 78/2500 [02:26<1:19:59,  1.98s/it]Applying perturbations:   3%|▎         | 79/2500 [02:28<1:19:59,  1.98s/it]Applying perturbations:   3%|▎         | 80/2500 [02:30<1:19:31,  1.97s/it]Applying perturbations:   3%|▎         | 81/2500 [02:32<1:18:39,  1.95s/it]Applying perturbations:   3%|▎         | 82/2500 [02:34<1:18:58,  1.96s/it]Applying perturbations:   3%|▎         | 83/2500 [02:36<1:18:19,  1.94s/it]Applying perturbations:   3%|▎         | 84/2500 [02:38<1:17:38,  1.93s/it]Applying perturbations:   3%|▎         | 85/2500 [02:40<1:18:09,  1.94s/it]Applying perturbations:   3%|▎         | 86/2500 [02:41<1:16:55,  1.91s/it]Applying perturbations:   3%|▎         | 87/2500 [02:43<1:16:22,  1.90s/it]